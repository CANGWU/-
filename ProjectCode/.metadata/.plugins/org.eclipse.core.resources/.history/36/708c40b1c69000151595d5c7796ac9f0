package dataserviceimpl;

import java.rmi.RemoteException;
import java.rmi.server.UnicastRemoteObject;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import dataservice.DManagementDataService;
import link.Helper;
import po.DriverPO;
import po.StaffPO;

public class DManagementDataImpl extends UnicastRemoteObject implements DManagementDataService {

	private DManagementDataImpl() throws RemoteException {
		super();
		// TODO Auto-generated constructor stub
	}

	@Override
	public DriverPO find(String id) {
		// TODO Auto-generated method stub
		ResultSet result;
		String sql = "SELECT*FROM staffpo WHERE workNumber= '" + id + "'";
		try {
	     result = Helper.run(sql);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		//Object result = null;
		
		DriverPO  driver = new DriverPO(result.getString("name"),result.getString("position",result.getString("workNumber"),result.getString("workPlaceNumber"))
				,result.getString("birthDate"),result.getString("idNumber"),result.getString("phoneNumber"),result.getString("address"),);
		return driver;
	}

	@Override
	public ArrayList<DriverPO> findAll() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void insert(DriverPO po) {
		// TODO Auto-generated method stub

	}

	@Override
	public void delect(DriverPO po) {
		// TODO Auto-generated method stub

	}

	@Override
	public void delect(String id) {
		// TODO Auto-generated method stub

	}

	@Override
	public void update(DriverPO po) {
		// TODO Auto-generated method stub

	}

	@Override
	public void init() {
		// TODO Auto-generated method stub

	}

	@Override
	public void finish() {
		// TODO Auto-generated method stub

	}

	public static DManagementDataImpl create() throws RemoteException{
		if(dm == null){
			synchronized(DManagementDataImpl.class){
		
		if(dm == null)
		dm = new DManagementDataImpl();
			}
		}
			
		return dm;
	}
	
   private volatile static DManagementDataImpl dm;
}
